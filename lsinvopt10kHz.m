function [out] = lsinvopt10kHz(in)

% Inverse filter coefficients of Loudspeaker 1 with applied lowpass filter
% at 10 kHz
ls1_inv_10kHz = [0.00171818136500944,0.0114197763665906,0.0416384442068358,...
                 0.103737102884307,0.191317598569703,0.266310362869000,...
                 0.272096528780350,0.178463626576396,0.0273161031811513,...
                 -0.0770242282735591,-0.0477594924066765,0.0928645717941258,...
                 0.210405188370008,0.170799769240083,-0.0241459675542668,...
                 -0.221786591632874,-0.256837350859181,-0.113962091150319,...
                 0.0571137528274939,0.0942392850291646,-0.0157069780435407,...
                 -0.138287187503158,-0.143870454996370,-0.0376124957970973,...
                 0.0698145423648839,0.0954514466140432,0.0599579273753730,...
                 0.0329336817943382,0.0395615345805599,0.0469236642633420,...
                 0.0289906738481464,0.00677977737412801,0.0119082604541982,...
                 0.0344984841493992,0.0357233845367071,0.00537244697480024,...
                 -0.0206045551187601,-0.0102791377684775,0.0184667486628305,...
                 0.0224454391379753,-0.00577090588489761,-0.0273213730819711,...
                 -0.0118959199037032,0.0194554280436481,0.0241222713076020,...
                 -0.00243108084987508,-0.0211825837339353,-0.00507493241011300,...
                 0.0236005809999600,0.0256695260211960,-1.66478292562625e-05];

out = filter(ls1_inv_10kHz,1,in);

end
             
%% Data to this function is generated by the code below            
% clc; clear all; close all;
% 
% addpath ../../../Misc/Anders/lab/log;
% 
% fs = 48000;
% 
% load('mls-1rep-4avg-16-480-coupler-LS1L-LS1LMIC-h_aver1isCMic-h_aver2isPMic.mat','h_aver1');
% ls1 = h_aver1;
% ls1 = 23.7411.*ls1;
% 
% nfft = length(ls1);
% 
% order = 50;
% [a1, gain] = lpc(double(ls1),order);
% a1 = 1.5299.*a1;
% 
% [B A] = ellip(12,0.1,100,[10e3]/(fs/2),'low');
% a1 = filter(B,A,a1);








